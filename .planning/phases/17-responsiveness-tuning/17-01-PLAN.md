---
phase: 17-responsiveness-tuning
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/pike-lsp-server/src/constants/index.ts
  - packages/vscode-pike/package.json
autonomous: true

must_haves:
  truths:
    - "Default diagnostic delay is 250ms instead of 500ms"
    - "Configuration bounds are 50-2000ms (tightened from 100-5000ms)"
    - "Both constant and package.json schema are updated atomically"
  artifacts:
    - path: "packages/pike-lsp-server/src/constants/index.ts"
      provides: "DIAGNOSTIC_DELAY_DEFAULT constant"
      contains: "export const DIAGNOSTIC_DELAY_DEFAULT = 250"
    - path: "packages/vscode-pike/package.json"
      provides: "pike.diagnosticDelay configuration schema"
      contains: '"default": 250'
      contains: '"minimum": 50'
      contains: '"maximum": 2000'
  key_links:
    - from: "packages/vscode-pike/src/extension.ts"
      to: "packages/pike-lsp-server/src/constants/index.ts"
      via: "initializationOptions.diagnosticDelay"
      pattern: "diagnosticDelay"
    - from: "packages/pike-lsp-server/src/features/diagnostics.ts"
      to: "globalSettings.diagnosticDelay"
      via: "validateDocumentDebounced()"
      pattern: "setTimeout.*globalSettings.diagnosticDelay"
---

<objective>
Update diagnostic delay default from 500ms to 250ms to improve responsiveness while maintaining CPU efficiency.

Purpose: Users will see diagnostics appear faster after typing stops. 250ms balances responsiveness (not sluggish) with CPU efficiency (not too frequent).

Output: Updated constant and schema with new default value and tightened bounds.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/17-responsiveness-tuning/17-CONTEXT.md
@.planning/phases/17-responsiveness-tuning/17-RESEARCH.md

@packages/pike-lsp-server/src/constants/index.ts
@packages/vscode-pike/package.json
</context>

<tasks>

<task type="auto">
  <name>Update DIAGNOSTIC_DELAY_DEFAULT constant to 250ms</name>
  <files>packages/pike-lsp-server/src/constants/index.ts</files>
  <action>
    Change line 59 from:
    ```typescript
    export const DIAGNOSTIC_DELAY_DEFAULT = 500;
    ```
    to:
    ```typescript
    export const DIAGNOSTIC_DELAY_DEFAULT = 250;
    ```

    This is the only change needed in this file. The constant is used in:
    - src/core/types.ts (defaultSettings)
    - Which flows to server.ts (initializationOptions)
    - Which flows to diagnostics.ts (validateDocumentDebounced)

    Do NOT change VALIDATION_DELAY_DEFAULT (line 19) - it's a separate constant for a different purpose.
  </action>
  <verify>grep "DIAGNOSTIC_DELAY_DEFAULT = 250" packages/pike-lsp-server/src/constants/index.ts</verify>
  <done>DIAGNOSTIC_DELAY_DEFAULT constant is 250</done>
</task>

<task type="auto">
  <name>Update pike.diagnosticDelay schema default and bounds</name>
  <files>packages/vscode-pike/package.json</files>
  <action>
    In the "pike.diagnosticDelay" property (lines 117-123), make three changes:

    1. Change "default" from 500 to 250
    2. Change "minimum" from 100 to 50 (allows shorter delays for fast machines)
    3. Change "maximum" from 5000 to 2000 (prevents excessive delays that make diagnostics feel broken)

    Result:
    ```json
    "pike.diagnosticDelay": {
        "type": "number",
        "default": 250,
        "minimum": 50,
        "maximum": 2000,
        "description": "Delay in milliseconds before running diagnostics after a document change"
    }
    ```

    No change needed to description - it's still accurate.
  </action>
  <verify>grep -A4 '"pike.diagnosticDelay"' packages/vscode-pike/package.json | grep -E '"default": 250|"minimum": 50|"maximum": 2000'</verify>
  <done>VSCode setting schema has default=250, min=50, max=2000</done>
</task>

</tasks>

<verification>
Run E2E test to verify LSP still works with new delay:
```bash
cd packages/vscode-pike && pnpm test:features:headless
```

This confirms the configuration change didn't break anything.
</verification>

<success_criteria>
- [x] DIAGNOSTIC_DELAY_DEFAULT = 250 in constants/index.ts
- [x] package.json has default: 250, minimum: 50, maximum: 2000
- [x] E2E tests still pass
- [x] No other files needed modification (extension.ts reads from package.json schema)
</success_criteria>

<output>
After completion, create `.planning/phases/17-responsiveness-tuning/17-01-SUMMARY.md`
</output>
